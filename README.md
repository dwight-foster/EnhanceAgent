# Enhance Agent
## Introduction
Enhance Agent is an LLM based agent to run various tools on images. It can zoom in on the image, upscale the image,
and describe the image for the user. It also takes advantage of whisper to provide a more interactive experience with voice commands.
For the image upscaling, it uses the EDSR model, for the image zooming, it uses the Florence model to generate the bounding boxes and then zooms in on the image. 
The description of the image is also generated by the Florence model. Then the Functionary v2.4 model is used to generate the text for the user and call the tools.

## Models Used
1. [Functionary](https://huggingface.co/meetkai/functionary-small-v2.4)
2. [Whisper](https://huggingface.co/ggerganov/whisper.cpp/tree/main)
3. [Florence](https://huggingface.co/microsoft/Florence-2-base-ft)
4. [EDSR](https://huggingface.co/eugenesiow/edsr-base)

## Installation
1. Clone the repository.
```bash
git clone https://github.com/dwight-foster/EnhanceAgent.git
```
2. Download the functionary gguf and whisper gguf from the links above.
3. Install llama-cpp-python server via pip.
```bash
pip install llama-cpp-python[server]
```
4. Install whisper cpp using the instructions [here](https://github.com/ggerganov/whisper.cpp)
5. Install the other requirements using the requirements.txt file.
```bash
pip install -r requirements.txt
```

## Usage
1. Run the llama-cpp server.
```bash
python3 -m llama_cpp.server --model weights/functionary-small-v2.4.Q4_0.gguf --chat_format functionary-v2 --hf_pretrained_model_name_or_path meetkai/functionary-small-v2.4 
```
2. Run the whisper server.
```bash
cd whisper.cpp
./server -m ../weights/ggml-medium-q5_0.bin
```
3. Run the run_gradio.py file.
```bash
python run_gradio.py
```
4. Open the link in the browser and upload an image.

